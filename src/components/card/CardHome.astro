---
import { categoriesFilePath } from "../../libs/constants";
import { getItemById, getSiteInfo } from "../../libs/csv";
import type { CategoryType } from "../../types/CategoryType";
import type { PostType } from "../../types/PostType";
import OptimizedImage from "../images/OptimizedImage.astro";
import { createCategoryUrl, createPostUrl } from "../../libs/urls";
import { getTranslations } from "../../i18n";

type PostProps = {
  post: PostType;
};

const { language } = getSiteInfo();
const t = getTranslations(language);
const { post } = Astro.props as PostProps;
const category = getItemById<CategoryType>(
    categoriesFilePath,
    post.category_id
);
---

<div class="bg-bg text-text rounded-lg shadow-md p-5 border border-border transition-colors duration-300">
  <h2 class="text-xl text-center font-bold text-primary mb-2">
    <a href={createPostUrl(post, category)} class="hover:underline">
      {post.title}
    </a>
  </h2>

  <p class="text-xs text-center text-muted my-3">
    üìç {t.LOCATION_TEXT + " "}
    <a
        href={createCategoryUrl(category)}
        class="hover:text-primary underline-offset-2"
    >
      {category?.title}
    </a>
  </p>

  <a href={createPostUrl(post, category)}>
    <OptimizedImage
        src={post.image}
        alt={post.title}
        class="rounded-lg mb-4 w-full h-48 object-cover"
    />
  </a>

  <p class="text-sm text-text text-center mb-4" set:html={post.content}></p>

  <div class="flex justify-center">
    <a
        href={createPostUrl(post, category)}
        class="inline-block bg-primary hover:bg-primary-hover text-text text-sm font-semibold px-6 py-2.5 rounded-lg shadow-md hover:shadow-lg ring-1 ring-border transition duration-150 ease-in-out"
    >
      {t.MESSAGE_CLICK_POST}
    </a>
  </div>
</div>
